INFO:services.loaders.data_loader:Loading raw data from ../data/raw/creditcard.csv
INFO:services.loaders.data_loader:Successfully load raw data: 284807 rows
INFO:services.validators.credit_fraud_validator:Data consistency is valid
WARNING:services.validators.credit_fraud_validator:1081 total duplicate rows
INFO:services.validators.credit_fraud_validator:Data quality assessment completed. Dataset is ready
INFO:services.loaders.data_loader:Splitting data by time
INFO:services.loaders.data_loader:Training: 199364
INFO:services.loaders.data_loader:Validation: 42721
INFO:services.loaders.data_loader:Test: 42722
INFO:services.loaders.data_loader:Saving data splits
INFO:services.loaders.data_loader:Saved splits to ../data/processed
INFO:services.preprocessors.fraud_preprocessor:Fitting preprocessing pipeline
INFO:services.preprocessors.fraud_preprocessor:Building preprocessing pipeline
INFO:services.preprocessors.fraud_preprocessor:Pipeline built
INFO:services.preprocessors.fraud_preprocessor:Features to scale: ['Time', 'Amount']
INFO:services.preprocessors.fraud_preprocessor:Features to keep: 28
INFO:services.preprocessors.fraud_preprocessor:Pipeline fitted
INFO:services.preprocessors.fraud_preprocessor:Learned parameters:
INFO:services.preprocessors.fraud_preprocessor:Time - Mean: 70444.42, Std: 34502.90
INFO:services.preprocessors.fraud_preprocessor:Amount - Mean: 89.77, Std: 248.91
INFO:pipelines.fraud_detection_pipeline:Preprocessing complete
INFO:services.handlers.imbalance_handler:Building smote sampler
INFO:services.handlers.imbalance_handler:Sampling strategy: 0.6
INFO:services.handlers.imbalance_handler:Sampler built: smote
INFO:services.handlers.imbalance_handler:Applying sampling strategy
INFO:services.handlers.imbalance_handler:Before - Total: 199,364, Fraud: 384, Ratio: 1.36%
INFO:services.handlers.imbalance_handler:After - Total: 318,368, Fraud: 119,388, Ratio: 37.50%
INFO:services.handlers.imbalance_handler:Sampling complete
INFO:services.tunner.hyper_tuner:Initiate tuner for random_forest model
INFO:services.tunner.hyper_tuner:Applying grid_search strategy
Fitting 5 folds for each of 27 candidates, totalling 135 fits
[CV] END max_depth=10, min_samples_split=2, n_estimators=100; total time= 1.9min
[CV] END max_depth=10, min_samples_split=2, n_estimators=100; total time= 2.0min
[CV] END max_depth=10, min_samples_split=2, n_estimators=100; total time= 2.0min
[CV] END max_depth=10, min_samples_split=2, n_estimators=100; total time= 2.0min
[CV] END max_depth=10, min_samples_split=2, n_estimators=100; total time= 2.0min
[CV] END max_depth=10, min_samples_split=2, n_estimators=200; total time= 3.4min
[CV] END max_depth=10, min_samples_split=2, n_estimators=200; total time= 4.0min
[CV] END max_depth=10, min_samples_split=2, n_estimators=200; total time= 4.1min
[CV] END max_depth=10, min_samples_split=2, n_estimators=200; total time= 4.2min
[CV] END max_depth=10, min_samples_split=2, n_estimators=200; total time= 4.2min
[CV] END max_depth=10, min_samples_split=5, n_estimators=100; total time= 2.1min
[CV] END max_depth=10, min_samples_split=5, n_estimators=100; total time= 2.0min
[CV] END max_depth=10, min_samples_split=5, n_estimators=100; total time= 2.0min
[CV] END max_depth=10, min_samples_split=5, n_estimators=100; total time= 2.1min
[CV] END max_depth=10, min_samples_split=2, n_estimators=300; total time= 6.2min
[CV] END max_depth=10, min_samples_split=2, n_estimators=300; total time= 6.3min
[CV] END max_depth=10, min_samples_split=2, n_estimators=300; total time= 6.3min
[CV] END max_depth=10, min_samples_split=2, n_estimators=300; total time= 6.3min
[CV] END max_depth=10, min_samples_split=5, n_estimators=100; total time= 2.0min
[CV] END max_depth=10, min_samples_split=2, n_estimators=300; total time= 6.2min
[CV] END max_depth=10, min_samples_split=5, n_estimators=200; total time= 4.1min
[CV] END max_depth=10, min_samples_split=5, n_estimators=200; total time= 4.0min
[CV] END max_depth=10, min_samples_split=5, n_estimators=200; total time= 4.1min
[CV] END max_depth=10, min_samples_split=5, n_estimators=200; total time= 4.1min
[CV] END max_depth=10, min_samples_split=5, n_estimators=200; total time= 4.1min
[CV] END max_depth=10, min_samples_split=10, n_estimators=100; total time= 2.0min
[CV] END max_depth=10, min_samples_split=10, n_estimators=100; total time= 2.0min
[CV] END max_depth=10, min_samples_split=10, n_estimators=100; total time= 2.0min
[CV] END max_depth=10, min_samples_split=5, n_estimators=300; total time= 6.1min
[CV] END max_depth=10, min_samples_split=5, n_estimators=300; total time= 6.0min
[CV] END max_depth=10, min_samples_split=5, n_estimators=300; total time= 6.1min
[CV] END max_depth=10, min_samples_split=10, n_estimators=100; total time= 2.1min
[CV] END max_depth=10, min_samples_split=10, n_estimators=100; total time= 2.1min
[CV] END max_depth=10, min_samples_split=5, n_estimators=300; total time= 6.1min
[CV] END max_depth=10, min_samples_split=5, n_estimators=300; total time= 6.2min
[CV] END max_depth=10, min_samples_split=10, n_estimators=200; total time= 4.1min
[CV] END max_depth=10, min_samples_split=10, n_estimators=200; total time= 4.1min
[CV] END max_depth=10, min_samples_split=10, n_estimators=200; total time= 4.1min
[CV] END max_depth=10, min_samples_split=10, n_estimators=200; total time= 4.1min
[CV] END max_depth=10, min_samples_split=10, n_estimators=200; total time= 4.1min
[CV] END max_depth=10, min_samples_split=10, n_estimators=300; total time= 6.1min
[CV] END max_depth=20, min_samples_split=2, n_estimators=100; total time= 2.7min
[CV] END max_depth=20, min_samples_split=2, n_estimators=100; total time= 2.7min
[CV] END max_depth=20, min_samples_split=2, n_estimators=100; total time= 2.7min
[CV] END max_depth=10, min_samples_split=10, n_estimators=300; total time= 5.9min
[CV] END max_depth=10, min_samples_split=10, n_estimators=300; total time= 5.9min
[CV] END max_depth=10, min_samples_split=10, n_estimators=300; total time= 6.3min
[CV] END max_depth=20, min_samples_split=2, n_estimators=100; total time= 2.5min
[CV] END max_depth=20, min_samples_split=2, n_estimators=100; total time= 3.0min
[CV] END max_depth=10, min_samples_split=10, n_estimators=300; total time= 6.4min
[CV] END max_depth=20, min_samples_split=2, n_estimators=200; total time= 5.2min
[CV] END max_depth=20, min_samples_split=2, n_estimators=200; total time= 5.6min
[CV] END max_depth=20, min_samples_split=2, n_estimators=200; total time= 5.0min
[CV] END max_depth=20, min_samples_split=2, n_estimators=200; total time= 5.2min
[CV] END max_depth=20, min_samples_split=2, n_estimators=200; total time= 5.5min
[CV] END max_depth=20, min_samples_split=5, n_estimators=100; total time= 2.7min
[CV] END max_depth=20, min_samples_split=5, n_estimators=100; total time= 2.7min
[CV] END max_depth=20, min_samples_split=5, n_estimators=100; total time= 2.7min
[CV] END max_depth=20, min_samples_split=2, n_estimators=300; total time= 8.0min
[CV] END max_depth=20, min_samples_split=2, n_estimators=300; total time= 8.0min
[CV] END max_depth=20, min_samples_split=2, n_estimators=300; total time= 8.1min
[CV] END max_depth=20, min_samples_split=5, n_estimators=100; total time= 2.7min
[CV] END max_depth=20, min_samples_split=5, n_estimators=100; total time= 2.8min
[CV] END max_depth=20, min_samples_split=2, n_estimators=300; total time= 8.0min
[CV] END max_depth=20, min_samples_split=2, n_estimators=300; total time= 8.2min
[CV] END max_depth=20, min_samples_split=5, n_estimators=200; total time= 5.4min
[CV] END max_depth=20, min_samples_split=5, n_estimators=200; total time= 5.4min
[CV] END max_depth=20, min_samples_split=5, n_estimators=200; total time= 5.3min
[CV] END max_depth=20, min_samples_split=5, n_estimators=200; total time= 5.4min
[CV] END max_depth=20, min_samples_split=5, n_estimators=200; total time= 5.4min
[CV] END max_depth=20, min_samples_split=10, n_estimators=100; total time= 2.7min
[CV] END max_depth=20, min_samples_split=10, n_estimators=100; total time= 2.7min
[CV] END max_depth=20, min_samples_split=10, n_estimators=100; total time= 2.7min
[CV] END max_depth=20, min_samples_split=5, n_estimators=300; total time= 8.0min
[CV] END max_depth=20, min_samples_split=5, n_estimators=300; total time= 8.0min
[CV] END max_depth=20, min_samples_split=10, n_estimators=100; total time= 2.7min
[CV] END max_depth=20, min_samples_split=5, n_estimators=300; total time= 8.0min
[CV] END max_depth=20, min_samples_split=10, n_estimators=100; total time= 2.7min
[CV] END max_depth=20, min_samples_split=5, n_estimators=300; total time= 7.8min
[CV] END max_depth=20, min_samples_split=5, n_estimators=300; total time= 8.2min
[CV] END max_depth=20, min_samples_split=10, n_estimators=200; total time= 5.3min
[CV] END max_depth=20, min_samples_split=10, n_estimators=200; total time= 5.3min
[CV] END max_depth=20, min_samples_split=10, n_estimators=200; total time= 5.3min
[CV] END max_depth=20, min_samples_split=10, n_estimators=200; total time= 5.3min
[CV] END max_depth=20, min_samples_split=10, n_estimators=200; total time= 5.4min
[CV] END max_depth=30, min_samples_split=2, n_estimators=100; total time= 2.5min
[CV] END max_depth=30, min_samples_split=2, n_estimators=100; total time= 2.5min
[CV] END max_depth=30, min_samples_split=2, n_estimators=100; total time= 2.5min
[CV] END max_depth=20, min_samples_split=10, n_estimators=300; total time= 7.8min
[CV] END max_depth=20, min_samples_split=10, n_estimators=300; total time=11.3min
[CV] END max_depth=20, min_samples_split=10, n_estimators=300; total time=11.3min
[CV] END max_depth=30, min_samples_split=2, n_estimators=100; total time= 6.2min
[CV] END max_depth=30, min_samples_split=2, n_estimators=100; total time= 6.1min
[CV] END max_depth=20, min_samples_split=10, n_estimators=300; total time=11.2min
[CV] END max_depth=20, min_samples_split=10, n_estimators=300; total time=11.3min
[CV] END max_depth=30, min_samples_split=2, n_estimators=200; total time= 8.5min
[CV] END max_depth=30, min_samples_split=2, n_estimators=200; total time= 8.8min
[CV] END max_depth=30, min_samples_split=2, n_estimators=200; total time= 5.1min
[CV] END max_depth=30, min_samples_split=2, n_estimators=200; total time= 5.1min
[CV] END max_depth=30, min_samples_split=2, n_estimators=200; total time= 5.6min
[CV] END max_depth=30, min_samples_split=5, n_estimators=100; total time= 2.4min
[CV] END max_depth=30, min_samples_split=5, n_estimators=100; total time= 2.1min
[CV] END max_depth=30, min_samples_split=2, n_estimators=300; total time= 8.0min
[CV] END max_depth=30, min_samples_split=5, n_estimators=100; total time= 2.5min
[CV] END max_depth=30, min_samples_split=2, n_estimators=300; total time= 7.9min
[CV] END max_depth=30, min_samples_split=2, n_estimators=300; total time= 7.8min
[CV] END max_depth=30, min_samples_split=5, n_estimators=100; total time= 2.3min
[CV] END max_depth=30, min_samples_split=5, n_estimators=100; total time= 2.6min
[CV] END max_depth=30, min_samples_split=2, n_estimators=300; total time= 7.7min
[CV] END max_depth=30, min_samples_split=2, n_estimators=300; total time= 8.1min
[CV] END max_depth=30, min_samples_split=5, n_estimators=200; total time= 5.1min
[CV] END max_depth=30, min_samples_split=5, n_estimators=200; total time= 5.1min
[CV] END max_depth=30, min_samples_split=5, n_estimators=200; total time= 4.9min
[CV] END max_depth=30, min_samples_split=5, n_estimators=200; total time= 4.8min
[CV] END max_depth=30, min_samples_split=5, n_estimators=200; total time= 5.1min
[CV] END max_depth=30, min_samples_split=10, n_estimators=100; total time= 2.4min
[CV] END max_depth=30, min_samples_split=10, n_estimators=100; total time= 2.7min
[CV] END max_depth=30, min_samples_split=10, n_estimators=100; total time= 2.8min
[CV] END max_depth=30, min_samples_split=5, n_estimators=300; total time= 7.8min
[CV] END max_depth=30, min_samples_split=10, n_estimators=100; total time= 2.1min
[CV] END max_depth=30, min_samples_split=5, n_estimators=300; total time= 7.9min
[CV] END max_depth=30, min_samples_split=10, n_estimators=100; total time= 2.8min
[CV] END max_depth=30, min_samples_split=5, n_estimators=300; total time= 8.1min
[CV] END max_depth=30, min_samples_split=5, n_estimators=300; total time= 7.1min
[CV] END max_depth=30, min_samples_split=5, n_estimators=300; total time= 8.3min
[CV] END max_depth=30, min_samples_split=10, n_estimators=200; total time= 5.3min
[CV] END max_depth=30, min_samples_split=10, n_estimators=200; total time= 5.2min
[CV] END max_depth=30, min_samples_split=10, n_estimators=200; total time= 5.2min
[CV] END max_depth=30, min_samples_split=10, n_estimators=200; total time= 5.1min
[CV] END max_depth=30, min_samples_split=10, n_estimators=200; total time= 5.1min
[CV] END max_depth=30, min_samples_split=10, n_estimators=300; total time= 6.8min
[CV] END max_depth=30, min_samples_split=10, n_estimators=300; total time= 6.8min
[CV] END max_depth=30, min_samples_split=10, n_estimators=300; total time= 6.5min
[CV] END max_depth=30, min_samples_split=10, n_estimators=300; total time= 6.4min
[CV] END max_depth=30, min_samples_split=10, n_estimators=300; total time= 6.5min
INFO:pipelines.fraud_detection_pipeline:Best random_forest params: {'max_depth': 30, 'min_samples_split': 2, 'n_estimators': 300}
INFO:pipelines.fraud_detection_pipeline:Best CV recall: 0.9999
INFO:pipelines.fraud_detection_pipeline:PIPELINE COMPLETE!\